<div class="box exportBox">
          <div class="boxTitle">Диапазон / Экспорт</div>
          <div class="boxContent">
            <div class="stylePanel">
            <div class="styleTitle">Оформление экспорта (шаблон XLSX)</div>

            <div class="row2 colorFmtRow">
              <label>Формат цвета:</label>
              <select id="colorFormat" title="Как показывать подпись под цветом">
                <option value="hex" selected>HEX</option>
                <option value="rgb">RGB</option>
              </select>
              <span class="mini">подпись под каждым цветом</span>
            </div>

            <div class="row2 styleCondRow">
              <label>Если мощность &lt;</label>
              <input id="rmThreshold" type="number" step="0.1" style="width:90px"/>
              <label>цвет:</label>
              <div class="colorStack">
                <input id="rmColor" type="color"/>
                <input id="rmColorCode" type="text" class="clrCodeInput" autocomplete="off" spellcheck="false"/>
              </div>
            </div>

            <div class="row2 styleCondRow">
              <label>t° нагнетания &gt;</label>
              <input id="tdThreshold" type="number" step="0.1" style="width:90px"/>
              <label>цвет:</label>
              <div class="colorStack">
                <input id="tdColor" type="color"/>
                <input id="tdColorCode" type="text" class="clrCodeInput" autocomplete="off" spellcheck="false"/>
              </div>
            </div>

            <div class="row2 styleCondRow">
              <label>t° всасывания &lt;</label>
              <input id="tsThreshold" type="number" step="0.1" style="width:90px"/>
              <label>цвет:</label>
              <div class="colorStack">
                <input id="tsColor" type="color"/>
                <input id="tsColorCode" type="text" class="clrCodeInput" autocomplete="off" spellcheck="false"/>
              </div>
            </div>

            <div class="scaleGrid">

              <div class="scaleRow">
                <div class="scaleName">min t° в объёме</div>
                <div class="scaleNorm">
                  <span class="sg">норма от</span>
                  <input id="wMin" type="number" step="0.1" title="Нижняя граница нормы"/>
                  <span class="sg">до</span>
                  <input id="wOpt" type="number" step="0.1" title="Верхняя граница нормы"/>
                </div>
                <div class="scaleColors">
                  <div class="scaleColorGroup"><span class="sg">низк.</span><input id="wCMin" type="color" title="Цвет: ниже нормы"/></div>
                  <div class="scaleColorGroup"><span class="sg">норма</span><input id="wCOpt" type="color" title="Цвет: в норме"/></div>
                  <div class="scaleColorGroup"><span class="sg">высок.</span><input id="wCMax" type="color" title="Цвет: выше нормы"/></div>
                </div>
              </div>

              <div class="scaleRow">
                <div class="scaleName">max t° в объёме</div>
                <div class="scaleNorm">
                  <span class="sg">норма от</span>
                  <input id="xMin" type="number" step="0.1" title="Нижняя граница нормы"/>
                  <span class="sg">до</span>
                  <input id="xOpt" type="number" step="0.1" title="Верхняя граница нормы"/>
                </div>
                <div class="scaleColors">
                  <div class="scaleColorGroup"><span class="sg">низк.</span><input id="xCMin" type="color" title="Цвет: ниже нормы"/></div>
                  <div class="scaleColorGroup"><span class="sg">норма</span><input id="xCOpt" type="color" title="Цвет: в норме"/></div>
                  <div class="scaleColorGroup"><span class="sg">высок.</span><input id="xCMax" type="color" title="Цвет: выше нормы"/></div>
                </div>
              </div>

              <div class="scaleRow">
                <div class="scaleName">сред t° в объёме</div>
                <div class="scaleNorm">
                  <span class="sg">норма от</span>
                  <input id="yMin" type="number" step="0.1" title="Нижняя граница нормы"/>
                  <span class="sg">до</span>
                  <input id="yOpt" type="number" step="0.1" title="Верхняя граница нормы"/>
                </div>
                <div class="scaleColors">
                  <div class="scaleColorGroup"><span class="sg">низк.</span><input id="yCMin" type="color" title="Цвет: ниже нормы"/></div>
                  <div class="scaleColorGroup"><span class="sg">норма</span><input id="yCOpt" type="color" title="Цвет: в норме"/></div>
                  <div class="scaleColorGroup"><span class="sg">высок.</span><input id="yCMax" type="color" title="Цвет: выше нормы"/></div>
                </div>
              </div>

            </div>

            <div class="row2">
              <button id="btnSaveStyle" type="button">Применить</button>
              <span id="styleStatus" class="statusText"></span>
              <span class="qmark" title="Эти настройки сохраняются в viewer_settings.json и применяются к следующей выгрузке «В шаблон XLSX». min/max/сред t° в объёме задаются независимо: укажи «нормальный диапазон» (min..opt). Ниже min — цвет «низк.», в диапазоне min..opt (включая границы) — цвет «норма», выше opt — цвет «высок.»">?</span>
            </div>


          </div>

          <div class="row2 stepRow">
            <label>Шаг:</label>
            <label class="check"><input id="stepAuto" type="checkbox" checked/> Авто</label>
            <select id="stepTarget" title="Целевое количество точек (примерно) для авто-шага">
              <option value="5000" selected>≈ 5k точек</option>
              <option value="10000">≈ 10k точек</option>
              <option value="20000">≈ 20k точек</option>
            </select>
            <input id="step" type="number" min="1" value="1" style="width:80px"
                   title="Прореживание данных: 1 — каждый замер; 2 — каждый второй; 10 — каждый десятый. Чем больше N, тем быстрее график и меньше размер экспорта, но ниже детализация."/>
            <span id="stepAutoInfo" class="mini"></span>
            <span class="qmark" title="Прореживание данных: 1 — каждый замер; 2 — каждый второй; 10 — каждый десятый. Чем больше N, тем быстрее график и меньше размер экспорта, но ниже детализация.">?</span>
          </div>
          <div class="helpText">
            Авто-режим подбирает шаг так, чтобы точек было примерно как в выбранной цели. Вручную: 1 — все точки, 2 — каждая 2-я и т.д.
          </div>

          <div class="row2">
            <label class="check"><input id="showLegend" type="checkbox" checked/> Легенда</label>
             <label class="check"><input id="tplExtra" type="checkbox" checked/> доп. каналы (Z…)</label>
            <span id="tplStatus" class="statusText"></span>
          </div>

          <div class="exportOptRow">

          </div>

          <div id="exportInfo" class="exportInfo">—</div>

          <div class="row2">
            <div class="rangeLine"><b>Выбранный интервал:</b> <span id="rangeText">—</span></div>
          </div>



          <div class="hint">
            Интервал экспорта берётся из видимой области графика по оси X.
            Увеличь/уменьши масштаб (выделением мышью или колесом). Текущий интервал покажу справа. Также можно двигать range-slider снизу.
          </div>

          <div class="exportBottomBar">
            <button id="btnTpl" type="button">В шаблон XLSX</button>
          </div>
          </div>
        </div>
